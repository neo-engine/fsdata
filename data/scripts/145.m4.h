// crystal cavern lighting
#include "scriptlib.m4.h"

SET_REGISTER( 2, 0 )

// Check how many crystals got activated
CHECK_FLAG( 216, 0, 1 )
    ADD_CONSTANT_TO_REGISTER( 2, 1 )
CHECK_FLAG( 217, 0, 1 )
    ADD_CONSTANT_TO_REGISTER( 2, 1 )
CHECK_FLAG( 218, 0, 1 )
    ADD_CONSTANT_TO_REGISTER( 2, 1 )
CHECK_FLAG( 219, 0, 1 )
    ADD_CONSTANT_TO_REGISTER( 2, 1 )

CHECK_REGISTER_N( 2, 0, 2 )
    SET_WEATHER( WEATHER_DARK_PERMANENT )
    JUMP_TO_END
CHECK_REGISTER_N( 2, 1, 2 )
    SET_WEATHER( WEATHER_FLASH_1 )
    JUMP_TO_END
CHECK_REGISTER_N( 2, 2, 2 )
    SET_WEATHER( WEATHER_FLASH_2 )
    JUMP_TO_END
CHECK_REGISTER_N( 2, 3, 2 )
    SET_WEATHER( WEATHER_DARK_FLASH_USED )
    JUMP_TO_END
SET_WEATHER( WEATHER_REGULAR )
END_OF_PROGRAM
